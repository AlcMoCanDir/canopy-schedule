<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Session 3 Schedule Builder</title>

<style>
* { box-sizing: border-box; }

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background: #f6f6f6;
}

.container {
    max-width: 1400px;
    margin: auto;
    background: white;
    border-radius: 8px;
    padding: 20px;
    border: 1px solid #ddd;
}

/* HEADER -------------------------------------------------------- */
h1 {
    text-align: center;
    color: #2a6f33;
    margin-bottom: 10px;
}

/* STUDENT NAME -------------------------------------------------- */
.student-info {
    text-align: center;
    margin-bottom: 20px;
}

.student-info input {
    border: 1px solid #2a6f33;
    border-radius: 4px;
    padding: 6px;
    width: 260px;
    font-size: 14px;
}

/* TABS ---------------------------------------------------------- */
.tabs {
    display: flex;
    gap: 10px;
    border-bottom: 2px solid #2a6f33;
    margin-bottom: 10px;
}
.tab {
    padding: 10px 20px;
    border-radius: 6px 6px 0 0;
    background: #dedede;
    cursor: pointer;
    border: none;
}
.tab.active { background: #2a6f33; color: white; }

.tab-content { display: none; }
.tab-content.active { display: block; }

/* SCHEDULE TABLE ------------------------------------------------ */
.schedule-table {
    width: 100%;
    border-collapse: collapse;
}
.schedule-table th, .schedule-table td {
    border: 1px solid #ccc;
    padding: 6px;
    font-size: 11px;
}
.schedule-table th {
    background: #2a6f33;
    color: white;
    font-size: 12px;
    text-align: center;
}
.time-col {
    width: 100px;
    background: #2274cd;
    color: white;
    font-weight: bold;
    text-align: center;
}

.lunch-row td {
    background: #fff3d4;
    text-align: center;
    font-weight: bold;
}

/* CLASS ITEMS --------------------------------------------------- */
.class-option {
    padding: 6px;
    margin-bottom: 4px;
    border-radius: 4px;
    font-size: 11px;
    display: flex;
    gap: 6px;
    align-items: center;
    cursor: pointer;
}

.commitment { background: #fff7b0; border-left: 4px solid #dac62c; }
.dropin { background: #daf0ff; border-left: 4px solid #2274cd; }
.private { background: #ffdede; border-left: 4px solid #c93d3d; }

.class-option.selected {
    border: 2px solid orange;
    background: #fff2d5;
}

/* BUTTONS ------------------------------------------------------- */
.action-buttons {
    text-align: center;
    margin-top: 25px;
}

.action-btn {
    display: inline-block;
    background: #2a6f33;
    color: white;
    padding: 10px 22px;
    border-radius: 4px;
    border: none;
    font-size: 15px;
    cursor: pointer;
    margin: 0 6px;
}

.action-btn.secondary { background: #2274cd; }
.action-btn.danger { background: #c93d3d; }

/* PRINT FOOTER --------------------------------------------------- */
#printMeta {
    display:none;
    font-size: 10px;
    text-align: right;
    margin-top: 10px;
}

/* PRINT MODE ---------------------------------------------------- */
@media print {

    body { background: white; padding: 0; zoom: 92%; }

    .student-info,
    .tabs,
    .action-buttons {
        display: none !important;
    }

    .container {
        border: none;
        padding: 0;
        box-shadow: none;
    }

    #printMeta {
        display: block !important;
        position: fixed;
        bottom: 10px;
        right: 20px;
        font-size: 10px;
        color: #444;
    }

    input[type="checkbox"] {
        display: none !important;
    }
}
</style>
</head>

<body>

<div class="container">

    <h1>Session 3 Schedule Builder</h1>

    <div class="student-info">
        <input id="studentName" placeholder="Enter student name...">
    </div>

    <div class="tabs">
        <button class="tab active" onclick="switchTab('full')">Full Schedule</button>
        <button class="tab" onclick="switchTab('my')">My Schedule</button>
    </div>

    <!-- FULL SCHEDULE TAB -->
    <div id="full-tab" class="tab-content active"></div>

    <!-- MY SCHEDULE TAB -->
    <div id="my-tab" class="tab-content">
        <div id="myScheduleList"></div>
    </div>

    <div class="action-buttons">
        <button class="action-btn secondary" onclick="printSchedule()">Print Schedule</button>
        <button class="action-btn danger" onclick="clearSchedule()">Clear My Schedule</button>
    </div>

    <!-- PRINT FOOTER -->
    <div id="printMeta"></div>

</div>

<script>
/* YOUR GOOGLE SCRIPT URL */
const SCRIPT_URL =
 "https://script.google.com/macros/s/AKfycbx5e6r3_wPmvRcpHwcCiEy2zBAzGsNQcpRWQAApimGEKi6OdXZgDyz0SwllCZ-SUtk9/exec";


/* MASTER DATA */
const TIMES = ["10:00-10:45","10:50-11:35","11:35-12:05","12:10-12:55","1:00-1:50","1:55-2:45"];

const DAYS = ["Monday","Tuesday","Wednesday","Thursday","Friday"];

const classes = {
    "10:00-10:45": {
        Monday:"Chemistry Lab|commitment",
        Tuesday:"Art Room|dropin",
        Wednesday:"Math Group A|commitment",
        Thursday:"1:1 Music Lesson|private",
        Friday:""
    },
    "10:50-11:35": {
        Monday:"Open Drawing|dropin",
        Tuesday:"Civics|commitment",
        Wednesday:"Writing Lab|commitment",
        Thursday:"Free Reading|dropin",
        Friday:"Piano Lesson|private"
    },
    "11:35-12:05": "Lunch",
    "12:10-12:55": {
        Monday:"Connection Circle|commitment",
        Tuesday:"Active Games|dropin",
        Wednesday:"Garden Club|dropin",
        Thursday:"Japanese|commitment",
        Friday:""
    },
    "1:00-1:50": {
        Monday:"Songwriting|commitment",
        Tuesday:"Cooking|dropin",
        Wednesday:"Open Art|dropin",
        Thursday:"Photography|commitment",
        Friday:""
    },
    "1:55-2:45": {
        Monday:"Sensory Lab|dropin",
        Tuesday:"Test Prep|commitment",
        Wednesday:"Theatre|commitment",
        Thursday:"Debate Club|commitment",
        Friday:""
    }
};

/* STORED SELECTIONS */
let selected = {};

/* RENDER FULL DISPLAY ---------------------------------------- */
function renderFull() {
    let html = `<table class="schedule-table">
    <thead><tr>
        <th class="time-col">Time</th>
        ${DAYS.map(d=>`<th>${d}</th>`).join("")}
    </tr></thead><tbody>`;

    TIMES.forEach(time=>{
        
        if(time==="11:35-12:05"){
            html += `<tr class="lunch-row">
                    <td class="time-col">${time}</td>
                    <td colspan="5">Lunch</td>
                </tr>`;
            return;
        }

        html += `<tr><td class="time-col">${time}</td>`;
        
        DAYS.forEach(day=>{
            const entry = classes[time][day];
            if(!entry){
                html+=`<td></td>`;
                return;
            }

            const [name,type] = entry.split("|");
            const key = `${time}-${day}`;
            const isSel = selected[key]===name;

            html += `<td>
                <div class="class-option ${type} ${isSel?"selected":""}"
                    onclick="choose('${key}','${name}')">
                    <input type="checkbox" ${isSel?"checked":""} onchange="choose('${key}','${name}')">
                    ${name}
                </div>
            </td>`;
        });

        html += `</tr>`;
    });

    html+="</tbody></table>";
    document.getElementById("full-tab").innerHTML = html;
}


/* RENDER MY CHOICES ---------------------------------------- */
function renderMine() {
    let html = `<table class="schedule-table">
        <thead><tr><th>Time</th><th>Class</th></tr></thead>
        <tbody>`;

    TIMES.forEach(time=>{
        html+=`<tr><td class="time-col">${time}</td><td>`;

        let match = "";
        Object.keys(selected).forEach(key=>{
            if(key.startsWith(time)){
                match = selected[key];
            }
        });

        html += match || "";
        html+="</td></tr>";
    });

    html+="</tbody></table>";
    document.getElementById("myScheduleList").innerHTML = html;
}


/* SELECTION LOGIC ---------------------------------------- */
function choose(key,name){
    selected[key] = name;
    saveLocal();
    renderFull();
    renderMine();
}


/* TAB SWITCHING */
function switchTab(tab){
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add("active");
    
    document.querySelectorAll(".tab-content").forEach(t=>t.classList.remove("active"));
    document.getElementById(`${tab}-tab`).classList.add("active");
}


/* SAVE TO LOCAL */
function saveLocal(){
    localStorage.setItem("MY_SCHEDULE_DATA",JSON.stringify(selected));
    localStorage.setItem("STUDENT_NAME",document.getElementById("studentName").value.trim());
}

/* RESTORE */
function restore(){
    const stored = localStorage.getItem("MY_SCHEDULE_DATA");
    if(stored) selected = JSON.parse(stored);

    const sn = localStorage.getItem("STUDENT_NAME");
    if(sn) document.getElementById("studentName").value = sn;
}


/* PRINT */
function printSchedule(){
    const today = new Date().toLocaleDateString();
    const footer = document.getElementById("printMeta");
    footer.textContent = `Created ${today}`;
    footer.style.display = "block";

    setTimeout(()=>window.print(),200);
}


/* RESET */
function clearSchedule(){
    if(!confirm("Clear your selected schedule?")) return;
    selected = {};
    saveLocal();
    renderFull();
    renderMine();
}


/* INIT */
restore();
renderFull();
renderMine();

</script>

</body>
</html>
